from dotenv import load_dotenv
from bot.app import create_app
from app.logger import logger

"""
Главный модуль запуска Telegram бота.

Этот скрипт выполняет следующие действия:
    - Загружает переменные окружения из файла .env
    - Создаёт экземпляр бота через функцию create_app()
    - Запускает бота в режиме polling
    - Логирует запуск и возможные ошибки

Пример использования:
    python main.py
"""


def main():
    """Основная функция запуска Telegram бота.

    Шаги выполнения:
        1. Загружает переменные окружения из .env с помощью load_dotenv().
        2. Создаёт экземпляр приложения бота через create_app().
        3. Запускает бота методом run_polling().
        4. Логирует все ключевые события и исключения.

    Raises:
        Exception: Любое исключение при создании или запуске бота
                   будет залогировано и проброшено выше.
    """
    # Загружаем переменные окружения из файла .env
    load_dotenv()

    try:
        # Логируем запуск бота
        logger.info("Запуск бота...")

        # Создаём объект приложения (бота)
        app = create_app()

        # Запускаем бота в режиме polling
        app.run_polling()
    except Exception as e:
        # Логируем исключение с полной информацией
        logger.exception("Ошибка при запуске бота\n%s", e)
        # Пробрасываем исключение выше для остановки программы
        raise


# Точка входа скрипта
if __name__ == "__main__":
    main()
